<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
	<title>商品列表</title>
	<script type="text/javascript" src="/js/jquery.min.js"></script>
	<link type="text/css" rel="stylesheet" href="/stylesheets/public.css" />
	<link type="text/css" rel="stylesheet" href="/stylesheets/goods_list.css" />
</head>
<body>
	<nav>
		<span><input type="text" /></span>
		<span>搜索</span>
	</nav>
	
	<main>
		<table id="tab">
			<tr>
				<th>
					<input type="checkbox" />
					<span>编号</span>
				</th>
				<th>商品名称</th>
				<th>货号</th>
				<th>价格</th>
				<th>上架</th>
				<th>精品</th>
				<th>新品</th>
				<th>热销</th>
				<th>推荐排序</th>
				<th>库存</th>
				<th>虚拟销量</th>
				<th>操作</th>
			</tr>
			<% for(var i=0; i <list.length;i++){ %>
			<tr>
				<td>
					<input type="checkbox" />
					<span><%= i %></span>
				</td>
				<td><%= list[i].goods_name %></td>
				<td><%= list[i].goods_number %></td>
				<td><%= list[i].price %></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td><%= list[i].count %></td>
				<td></td>
			</tr>
			<% } %>
		</table>
	</main>
	<footer id="foot">
		<!--<div class="txt"  id="txt" contenteditable="true">2</div> //div可编辑-->
		<input class="txt" type="text"  id="txt" value="2"/>
		<select class="num" id="numF">
			<!--<option>1</option>-->
		</select>
	</footer>
	<!--<div>
		<%= list.length %>
	</div>-->
</body>
	<script type="text/javascript">
		window.onload = function (){
//			console.log($("#tab").children().children("tr").length);
			function changeTxt(){
				var trs=$("#tab").children(0).children().length-1;
				var txt = $("#txt").val();
				var numF = $("#numF");
				numF.html("");
				var nums = Math.ceil(trs/txt);
				for(var i = 0 ; i < nums ;i++){
					var op = $("<option>");
					op.html(i+1);
					numF.append(op);
				}
			}
			
			$("#foot").on("keydown",$("#txt"),function(ee){
				var e = ee || event;
				if(e.keyCode == 13){
					changeTxt();
					show();
				}
			})
			$("#numF").change(function(){
//				changeTxt();
					show();
			})
			function show(){
				var txt = $("#txt").val();
				var num = $("#numF").val();
				console.log(num)
				var trs=$("#tab").children(0).children().length;
				var max=num*txt>trs?trs:num*txt;
				$("#tab").children(0).children().eq(0).siblings().css({display:"none"});
				for(var i=txt*(num-1)+1;i<=max;i++){
					$("#tab").children(0).children().eq(i).css({display:"table-row"});
				}
			}
			changeTxt();
			show();
			
			/*$.ajax({
				type:"post",
				url:"/api/goods_list",
				success : function(res){
					console.log(res);
				}
			});*/
//			alert($("#tab").children().children().length)
		}
/*		$.ajax({
			type:"get",
			url:"/goods_list",
			success : function(res){
				console.log(res);
			}
		});*/
	</script>
</html>